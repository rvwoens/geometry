LASTTAG=`git describe --abbrev=0 --tags`
echo "Current version tag $LASTTAG"
if [ -z $2 ]; then
	NEWTAG=`newversion -x $LASTTAG`
else
	echo "Usage: pusher <override-comment> <override-version>"
	echo "Use version format vX.X.XX"
	NEWTAG=$1
fi
#echo "Running style fix"
#composer run fix
echo "Creating new version tag $NEWTAG"
echo "<?php\n// auto-generated by pusher\n\nreturn [\n\t'version'=>'$NEWTAG'\n];\n" > ./src/version.php
git add --all .
git commit -a -m "${1:-Release $NEWTAG}"
git tag "$NEWTAG"
echo ">>>> git pull origin"
git pull origin
echo ">>>> git push origin"
git push origin
echo -e ">>>> git push origin --tags "
git push origin --tags

